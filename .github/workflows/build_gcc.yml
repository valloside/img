name: CMake Build with GCC

on:
    push:
        branches:
            - master
    pull_request:
        branches:
            - master

jobs:
    build-with-gcc:
        runs-on: windows-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v3
              with:
                  submodules: recursive

            - name: Setup MSYS2 environment
              uses: msys2/setup-msys2@v2
              with:
                  update: true
                  install: >-
                      mingw-w64-x86_64-gcc 
                      mingw-w64-x86_64-make
                  msystem: MINGW64

            - name: Configure
              run: |
                  mkdir build
                  cd build
                  cmake -G "MinGW Makefiles" -DCMAKE_BUILD_TYPE=Release ..

            - name: Build
              run: |
                  cd build
                  cmake --build . --config Release
